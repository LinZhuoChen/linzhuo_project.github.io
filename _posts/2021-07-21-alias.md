---
title: 图嵌入中必备的采样方法｜Alias算法介绍
categories: graph embedding
tags:
- 推荐系统
---

大家好，这里是Linzhuo，之前我们介绍过了Deepwalk，Node2Vec，LINE，SDNE等相关图嵌入的方法。最近Linzhuo会将这些图嵌入的方法介绍整理成tutorial pdf文档，并附上代码实现，请大家期待啦。

在实现这些算法的过程中，Linzhuo发现，为了实现指定概率的节点游走，会经常用到Alias算法。该方法仅仅需要O(1)的时间复杂度，即可实现概率采样。我们接下来将详细介绍这种方法。

### 问题介绍
首先，我们假设一共有四个事件，分别为A，B，C，D，发生的概率分别为0.3, 0.1, 0.1, 0.5。我们如何实现按照不同的概率，来模拟A，B，C，D事件的发生情况呢？
一种直观的方法是，根据概率生成对应数量的数字，然后等概率采样即可。例如我们可以根据上述概率分布生成$[1,1,1,2,3,4,4,4,4,4]$,之后等概率采样，采样到哪个数字就对应着发生什么事件。这种方法简单直接，但仅仅适用于少量事件的情况。随着事件数目的增多，这种方法所占据的空间也会增多。

本文介绍的Alias算法，可以实现O(1)时间复杂度的概率抽样，我们下面将详细介绍。

### Alias算法介绍
我们知道，等概率抽样和二项抽样（对二项分布的事件进行抽样）的时间复杂度均为O(1)。Alias算法即将等概率抽样和二项抽样结合，实现不等概率事件下O(1)时间复杂度的抽样。我们以上述四个事件A，B，C，D四个事件举例。图1为A，B，C，D四个事件的原始概率分布，不同颜色代表不同的事件。


![](https://files.mdnice.com/user/16260/3120b7f8-5a27-4d6d-8c38-70b37f3fc278.png)
<center>图1：A,B,C,D的概率分布</center>

Alias算法首先，**对每个事件发生的概率乘以事件的数目**，即乘以4，结果如图2所示：


![](https://files.mdnice.com/user/16260/04accd60-16e6-4bab-bb96-fdf585ab9847.png)

<center>图2：A,B,C,D乘以事件数目后的概率分布</center>

之后，**Alias算法会将A，B，C，D四个事件拼成等概率的分布**，如图3所示：


![](https://files.mdnice.com/user/16260/ff775189-793b-4474-8b27-7f7f50f5652c.png)
<center>图3：A,B,C,D拼成等概率分布</center>

**在拼接的过程中，每一列的最大值为1，而且每一列最多有两个事件**。这样对于每一列来说，他们被抽中的概率是等同的。同时在每一列中，每个事件都符合二项分布。Alias算法首先会通过等概率抽样，随机选取其中一列，接着会根据该列的二项分布，去选取发生的事件。

举例来说，如图3所示，Alias算法首先会依据等概率分布随机采样一列，假如采样到了最后一列。之后Alias算法会根据最后一列的$[0.8, 0.2]$二项分布采样。如果采样到了0.2概率的事件，则发生事件A，否则发生事件D。

### 结论

总的来说，Alias算法的流程如下：

 - 首先对每个事件发生的概率乘以事件的数目。
 - 接着将所有事件拼成等概率的分布，每一列的最大值为1，而且每一列最多有两个事件。整体来看，即等概率分布与二项分布的组合：列与列之间的等概率分布，而列内为二项分布。
 - 最后依据等概率采样随机采取其中一列，同时依据该列所在的二项分布采样事件。

### 参考文献
https://www.wangliguang.cn/?p=9



